module.exports=[22605,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(92258),e=a.i(43108),f=a.i(3314),g=a.i(16201),h=a.i(92e3),i=a.i(32860),j=a.i(46842),k=a.i(96221),l=a.i(77156),m=a.i(41379);let n=(0,a.i(70106).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var o=a.i(69520),p=a.i(60779),q=a.i(50944);a.s(["default",0,()=>{let[a,r]=(0,c.useState)(1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(0),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(!1),O=(0,q.useRouter)();(0,c.useEffect)(()=>{P(),Q()},[]),(0,c.useEffect)(()=>{if(G>0){let a=setTimeout(()=>H(G-1),1e3);return()=>clearTimeout(a)}},[G]);let P=async()=>{try{let a=localStorage.getItem("token"),b=await fetch(`${p.default}/auth/checktoken`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}}),c=await b.json();c.success?(t(c.profile),F("")):O.push("/login")}catch(a){F(a.message||"Failed to fetch user details. Please try again."),console.error("Error fetching user details:",a)}},Q=async()=>{D(!0),F("");try{let a=localStorage.getItem("token");if(!a)throw Error("No authentication token found");let b=await fetch(`${p.default}/auth/getprofile`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!b.ok){let a=await b.json().catch(()=>null);throw Error(a?.message||"Failed to fetch user details")}let c=await b.json();if(c.profile)t(c.profile),F("");else throw Error("User profile not found")}catch(a){F(a.message||"Failed to fetch user details. Please try again."),console.error("Error fetching user details:",a)}finally{D(!1)}},R=async()=>{if(!s||!s.email)return void F("User details not available. Please refresh the page.");B(!0),F("");try{let a=localStorage.getItem("token"),b=await fetch(`${p.default}/auth/send-otp`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({email:s.email,type:"PIN_RESET"})});if(!b.ok){let a=await b.json().catch(()=>null);throw Error(a?.message||"Failed to send OTP")}N(!0),H(60),r(2)}catch(a){F(a.message||"Failed to send OTP. Please try again."),console.error("Error sending OTP:",a)}finally{B(!1)}},S=async()=>{v(""),await R()},T=async()=>{if(6!==u.length)return void F("Please enter a 6-digit OTP");B(!0),F("");try{let a=localStorage.getItem("token"),b=await fetch(`${p.default}/auth/verify-otp`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({otp:u,type:"PIN_RESET"})});if(!b.ok){let a=await b.json().catch(()=>null);throw Error(a?.message||"Invalid OTP")}r(3),F("")}catch(a){F(a.message||"Invalid OTP. Please try again."),console.error("Error verifying OTP:",a)}finally{B(!1)}},U=async()=>{if(6!==w.length)return void F("PIN must be 6 digits");if(w!==y)return void F("PINs do not match");B(!0),F("");try{let a=localStorage.getItem("token"),b=await fetch(`${p.default}/auth/reset-pin`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({pin:w,timestamp:new Date().toISOString()})});if(!b.ok){let a=await b.json().catch(()=>null);throw Error(a?.message||"Failed to reset PIN")}r(4)}catch(a){F(a.message||"Failed to reset PIN. Please try again."),console.error("Error resetting PIN:",a)}finally{B(!1)}},V=(a,b)=>{/^\d*$/.test(a)&&a.length<=6&&("new"===b?x(a):z(a),F(""))},W=a=>{if(!a)return"";let[b,c]=a.split("@"),d=b.substring(0,2)+"****";return`${d}@${c}`};return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-gray-100 to-white flex items-center justify-center p-4 sm:p-6 md:p-8",children:(0,b.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl max-w-md w-full p-6 sm:p-8 border border-gray-100 relative overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-gray-50 to-gray-100 rounded-full -translate-y-1/2 translate-x-1/2 z-0"}),(0,b.jsx)("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-gray-50 to-gray-100 rounded-full translate-y-1/2 -translate-x-1/2 z-0"}),(0,b.jsxs)("div",{className:"relative z-10",children:[(0,b.jsxs)("div",{className:"mb-8 text-center",children:[(0,b.jsxs)("h2",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:[1===a&&"Reset Your PIN",2===a&&"Verify OTP",3===a&&"Create New PIN",4===a&&"Success!"]}),(0,b.jsx)("div",{className:"mt-2 w-16 h-1 bg-black mx-auto rounded-full"})]}),E&&1!==a&&(0,b.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-center text-red-700 animate-shake",children:[(0,b.jsx)(h.AlertCircle,{className:"w-5 h-5 mr-2 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:E})]}),(0,b.jsxs)("div",{className:"transition-all duration-300 ease-in-out transform",children:[1===a&&(0,b.jsx)("div",{className:"animate-fadeIn",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6 sm:p-8 border border-gray-200 backdrop-blur-sm",children:[(0,b.jsx)("div",{className:"w-20 h-20 mx-auto mb-4 bg-black rounded-full flex items-center justify-center",children:(0,b.jsx)(j.User,{className:"w-10 h-10 text-white"})}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-black mb-3",children:"Verification Required"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"We need to verify your identity before resetting your PIN"}),C?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,b.jsx)(k.Loader2,{className:"w-8 h-8 animate-spin text-black mb-3"}),(0,b.jsx)("span",{className:"text-gray-600",children:"Loading your details..."})]}):s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-gray-200 mb-6",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Name"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-black",children:s.name||s.fullName||"User"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"OTP will be sent to"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-black",children:W(s.email)})]})]}),(0,b.jsx)("button",{onClick:R,disabled:A,className:"w-full bg-black text-white py-4 rounded-xl font-medium hover:bg-gray-900 transform hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center group",children:A?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Sending OTP..."]}):(0,b.jsxs)(b.Fragment,{children:["Send OTP to Email",(0,b.jsx)(n,{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform"})]})})]}):(0,b.jsxs)("div",{className:"py-8",children:[(0,b.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:(0,b.jsx)(h.AlertCircle,{className:"w-8 h-8 text-red-600"})}),(0,b.jsx)("p",{className:"text-red-600 mb-4",children:"Failed to load user details"}),(0,b.jsxs)("button",{onClick:Q,className:"bg-black text-white px-6 py-3 rounded-xl font-medium hover:bg-gray-900 transition-all flex items-center justify-center mx-auto",children:[(0,b.jsx)(o.RefreshCw,{className:"w-4 h-4 mr-2"}),"Retry"]})]})]})})}),2===a&&(0,b.jsx)("div",{className:"animate-fadeIn",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center mb-4",children:[(0,b.jsx)("div",{className:"w-20 h-20 mx-auto mb-4 bg-black rounded-full flex items-center justify-center",children:(0,b.jsx)(d.Mail,{className:"w-10 h-10 text-white"})}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-black mb-2",children:"Enter OTP"}),(0,b.jsxs)("p",{className:"text-gray-600",children:["We sent a 6-digit code to"," ",s&&W(s.email)]})]}),(0,b.jsx)("div",{className:"relative",children:(0,b.jsx)("input",{type:"text",maxLength:"6",value:u,onChange:a=>{var b;return b=a.target.value,void(/^\d*$/.test(b)&&b.length<=6&&(v(b),F("")))},placeholder:"000000",className:"w-full px-4 py-4 text-center text-xl sm:text-2xl font-bold tracking-[0.5em] border-2 border-gray-300 rounded-xl focus:border-black focus:ring-2 focus:ring-black/5 focus:outline-none transition-all bg-white text-black placeholder-gray-300",autoComplete:"off",autoFocus:!0})}),(0,b.jsx)("div",{className:"text-center",children:G>0?(0,b.jsxs)("p",{className:"text-gray-500",children:["Resend OTP in"," ",(0,b.jsxs)("span",{className:"font-semibold text-black",children:[G,"s"]})]}):(0,b.jsx)("button",{onClick:S,disabled:A,className:"text-black hover:text-gray-700 font-medium underline underline-offset-4 disabled:opacity-50 transition-colors",children:"Resend OTP"})}),(0,b.jsx)("button",{onClick:T,disabled:A||6!==u.length,className:"w-full mt-6 bg-black text-white py-4 rounded-xl font-medium hover:bg-gray-900 transform hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center",children:A?(0,b.jsx)(k.Loader2,{className:"w-5 h-5 animate-spin"}):(0,b.jsxs)(b.Fragment,{children:["Verify OTP",(0,b.jsx)(i.ArrowRight,{className:"w-5 h-5 ml-2"})]})}),(0,b.jsx)("button",{onClick:()=>{r(1),v(""),N(!1),H(0)},className:"w-full mt-3 text-gray-600 hover:text-black font-medium transition-colors",children:"← Back to previous step"})]})}),3===a&&(0,b.jsx)("div",{className:"animate-fadeIn",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center mb-4",children:[(0,b.jsx)("div",{className:"w-20 h-20 mx-auto mb-4 bg-black rounded-full flex items-center justify-center",children:(0,b.jsx)(e.Lock,{className:"w-10 h-10 text-white"})}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-black mb-2",children:"Set New PIN"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Create a secure 6-digit PIN"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New PIN"}),(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("input",{type:I?"text":"password",maxLength:"6",value:w,onChange:a=>V(a.target.value,"new"),placeholder:"••••••",className:"w-full px-4 py-4 text-center text-xl sm:text-2xl font-bold tracking-[0.5em] border-2 border-gray-300 rounded-xl focus:border-black focus:ring-2 focus:ring-black/5 focus:outline-none transition-all bg-white text-black placeholder-gray-400 group-hover:border-gray-400",autoComplete:"off",autoFocus:!0}),(0,b.jsx)("button",{type:"button",onClick:()=>J(!I),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-black transition-colors",children:I?(0,b.jsx)(m.EyeOff,{className:"w-5 h-5"}):(0,b.jsx)(l.Eye,{className:"w-5 h-5"})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm PIN"}),(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("input",{type:K?"text":"password",maxLength:"6",value:y,onChange:a=>V(a.target.value,"confirm"),placeholder:"••••••",className:"w-full px-4 py-4 text-center text-xl sm:text-2xl font-bold tracking-[0.5em] border-2 border-gray-300 rounded-xl focus:border-black focus:ring-2 focus:ring-black/5 focus:outline-none transition-all bg-white text-black placeholder-gray-400 group-hover:border-gray-400",autoComplete:"off"}),(0,b.jsx)("button",{type:"button",onClick:()=>L(!K),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-black transition-colors",children:K?(0,b.jsx)(m.EyeOff,{className:"w-5 h-5"}):(0,b.jsx)(l.Eye,{className:"w-5 h-5"})})]})]}),6===w.length&&6===y.length&&w!==y&&(0,b.jsxs)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center text-yellow-700",children:[(0,b.jsx)(h.AlertCircle,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm",children:"PINs do not match"})]}),(0,b.jsx)("button",{onClick:U,disabled:A||6!==w.length||6!==y.length||w!==y,className:"w-full mt-6 bg-black text-white py-4 rounded-xl font-medium hover:bg-gray-900 transform hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center",children:A?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Resetting PIN..."]}):(0,b.jsxs)(b.Fragment,{children:["Reset PIN",(0,b.jsx)(f.Shield,{className:"w-5 h-5 ml-2"})]})})]})}),4===a&&(0,b.jsx)("div",{className:"animate-fadeIn",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl p-8 sm:p-10 border border-green-200",children:[(0,b.jsx)("div",{className:"w-20 h-20 sm:w-24 sm:h-24 mx-auto mb-6 bg-green-100 rounded-full flex items-center justify-center animate-bounce",children:(0,b.jsx)(g.CheckCircle,{className:"w-12 h-12 sm:w-14 sm:h-14 text-green-600"})}),(0,b.jsx)("h3",{className:"text-3xl font-bold text-black mb-3",children:"Success!"}),(0,b.jsx)("p",{className:"text-gray-600 mb-2",children:"Your PIN has been successfully reset"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-8",children:"You can now use your new PIN for transactions"}),(0,b.jsxs)("button",{onClick:()=>window.location.href="/dashboard",className:"bg-black text-white px-8 py-4 rounded-xl font-medium hover:bg-gray-900 transform hover:-translate-y-0.5 transition-all inline-flex items-center",children:["Go to Dashboard",(0,b.jsx)(i.ArrowRight,{className:"w-5 h-5 ml-2"})]})]})})})]})]})]})})}],22605)}];

//# sourceMappingURL=src_app_resetpin_page_dd078d0e.js.map